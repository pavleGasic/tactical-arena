{
"version":3,
"file":"module$node_modules$$pixi$core$lib$shader$utils$generateUniformBufferSync.js",
"lineCount":79,
"mappings":"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",
"sources":["node_modules/@pixi/core/lib/shader/utils/generateUniformBufferSync.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$pixi$core$lib$shader$utils$generateUniformBufferSync\"] = function(global,require,module,exports) {\n\"use strict\";\nrequire(\"./index.js\");\nvar uniformParsers = require(\"./uniformParsers.js\"), mapSize = require(\"./mapSize.js\");\nfunction uboUpdate(_ud, _uv, _renderer, _syncData, buffer) {\n  _renderer.buffer.update(buffer);\n}\nconst UBO_TO_SINGLE_SETTERS = {\n  float: `\n        data[offset] = v;\n    `,\n  vec2: `\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    `,\n  vec3: `\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    `,\n  vec4: `\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    `,\n  mat2: `\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    `,\n  mat3: `\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    `,\n  mat4: `\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    `\n}, GLSL_TO_STD40_SIZE = {\n  float: 4,\n  vec2: 8,\n  vec3: 12,\n  vec4: 16,\n  int: 4,\n  ivec2: 8,\n  ivec3: 12,\n  ivec4: 16,\n  uint: 4,\n  uvec2: 8,\n  uvec3: 12,\n  uvec4: 16,\n  bool: 4,\n  bvec2: 8,\n  bvec3: 12,\n  bvec4: 16,\n  mat2: 16 * 2,\n  mat3: 16 * 3,\n  mat4: 16 * 4\n};\nfunction createUBOElements(uniformData) {\n  const uboElements = uniformData.map((data) => ({\n    data,\n    offset: 0,\n    dataLen: 0,\n    dirty: 0\n  }));\n  let size = 0, chunkSize = 0, offset = 0;\n  for (let i = 0; i < uboElements.length; i++) {\n    const uboElement = uboElements[i];\n    if (size = GLSL_TO_STD40_SIZE[uboElement.data.type], uboElement.data.size > 1 && (size = Math.max(size, 16) * uboElement.data.size), uboElement.dataLen = size, chunkSize % size !== 0 && chunkSize < 16) {\n      const lineUpValue = chunkSize % size % 16;\n      chunkSize += lineUpValue, offset += lineUpValue;\n    }\n    chunkSize + size > 16 ? (offset = Math.ceil(offset / 16) * 16, uboElement.offset = offset, offset += size, chunkSize = size) : (uboElement.offset = offset, chunkSize += size, offset += size);\n  }\n  return offset = Math.ceil(offset / 16) * 16, { uboElements, size: offset };\n}\nfunction getUBOData(uniforms, uniformData) {\n  const usedUniformDatas = [];\n  for (const i in uniforms)\n    uniformData[i] && usedUniformDatas.push(uniformData[i]);\n  return usedUniformDatas.sort((a, b) => a.index - b.index), usedUniformDatas;\n}\nfunction generateUniformBufferSync(group, uniformData) {\n  if (!group.autoManage)\n    return { size: 0, syncFunc: uboUpdate };\n  const usedUniformDatas = getUBOData(group.uniforms, uniformData), { uboElements, size } = createUBOElements(usedUniformDatas), funcFragments = [`\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    `];\n  for (let i = 0; i < uboElements.length; i++) {\n    const uboElement = uboElements[i], uniform = group.uniforms[uboElement.data.name], name = uboElement.data.name;\n    let parsed = !1;\n    for (let j = 0; j < uniformParsers.uniformParsers.length; j++) {\n      const uniformParser = uniformParsers.uniformParsers[j];\n      if (uniformParser.codeUbo && uniformParser.test(uboElement.data, uniform)) {\n        funcFragments.push(\n          `offset = ${uboElement.offset / 4};`,\n          uniformParsers.uniformParsers[j].codeUbo(uboElement.data.name, uniform)\n        ), parsed = !0;\n        break;\n      }\n    }\n    if (!parsed)\n      if (uboElement.data.size > 1) {\n        const size2 = mapSize.mapSize(uboElement.data.type), rowSize = Math.max(GLSL_TO_STD40_SIZE[uboElement.data.type] / 16, 1), elementSize = size2 / rowSize, remainder = (4 - elementSize % 4) % 4;\n        funcFragments.push(`\n                cv = ud.${name}.value;\n                v = uv.${name};\n                offset = ${uboElement.offset / 4};\n\n                t = 0;\n\n                for(var i=0; i < ${uboElement.data.size * rowSize}; i++)\n                {\n                    for(var j = 0; j < ${elementSize}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${remainder};\n                }\n\n                `);\n      } else {\n        const template = UBO_TO_SINGLE_SETTERS[uboElement.data.type];\n        funcFragments.push(`\n                cv = ud.${name}.value;\n                v = uv.${name};\n                offset = ${uboElement.offset / 4};\n                ${template};\n                `);\n      }\n  }\n  return funcFragments.push(`\n       renderer.buffer.update(buffer);\n    `), {\n    size,\n    // eslint-disable-next-line no-new-func\n    syncFunc: new Function(\n      \"ud\",\n      \"uv\",\n      \"renderer\",\n      \"syncData\",\n      \"buffer\",\n      funcFragments.join(`\n`)\n    )\n  };\n}\nexports.createUBOElements = createUBOElements;\nexports.generateUniformBufferSync = generateUniformBufferSync;\nexports.getUBOData = getUBOData;\n//# sourceMappingURL=generateUniformBufferSync.js.map\n\n};"],
"names":["shadow$provide","global","require","module","exports","uboUpdate","_ud","_uv","_renderer","_syncData","buffer","update","createUBOElements","uniformData","uboElements","map","data","offset","dataLen","dirty","size","chunkSize","i","length","uboElement","GLSL_TO_STD40_SIZE","type","Math","max","lineUpValue","ceil","getUBOData","uniforms","usedUniformDatas","push","sort","a","b","index","uniformParsers","mapSize","UBO_TO_SINGLE_SETTERS","float","vec2","vec3","vec4","mat2","mat3","mat4","int","ivec2","ivec3","ivec4","uint","uvec2","uvec3","uvec4","bool","bvec2","bvec3","bvec4","generateUniformBufferSync","group","autoManage","syncFunc","funcFragments","uniform","name","parsed","j","uniformParser","codeUbo","test","size2","rowSize","elementSize","template","Function","join"]
}
