{
"version":3,
"file":"module$node_modules$pixi_DOT_js$lib$rendering$renderers$shared$shader$UboSystem.js",
"lineCount":60,
"mappings":"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",
"sources":["node_modules/pixi_DOT_js/lib/rendering/renderers/shared/shader/UboSystem.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$pixi_DOT_js$lib$rendering$renderers$shared$shader$UboSystem\"] = function(global,require,module,exports) {\n'use strict';\n\nvar unsafeEvalSupported = require('../../../../utils/browser/unsafeEvalSupported.js');\nvar Buffer = require('../buffer/Buffer.js');\nvar _const = require('../buffer/const.js');\n\n\"use strict\";\nclass UboSystem {\n  constructor(adaptor) {\n    /** Cache of uniform buffer layouts and sync functions, so we don't have to re-create them */\n    this._syncFunctionHash = /* @__PURE__ */ Object.create(null);\n    this._adaptor = adaptor;\n    this._systemCheck();\n  }\n  /**\n   * Overridable function by `pixi.js/unsafe-eval` to silence\n   * throwing an error if platform doesn't support unsafe-evals.\n   * @private\n   */\n  _systemCheck() {\n    if (!unsafeEvalSupported.unsafeEvalSupported()) {\n      throw new Error(\"Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.\");\n    }\n  }\n  ensureUniformGroup(uniformGroup) {\n    const uniformData = this.getUniformGroupData(uniformGroup);\n    uniformGroup.buffer || (uniformGroup.buffer = new Buffer.Buffer({\n      data: new Float32Array(uniformData.layout.size / 4),\n      usage: _const.BufferUsage.UNIFORM | _const.BufferUsage.COPY_DST\n    }));\n  }\n  getUniformGroupData(uniformGroup) {\n    return this._syncFunctionHash[uniformGroup._signature] || this._initUniformGroup(uniformGroup);\n  }\n  _initUniformGroup(uniformGroup) {\n    const uniformGroupSignature = uniformGroup._signature;\n    let uniformData = this._syncFunctionHash[uniformGroupSignature];\n    if (!uniformData) {\n      const elements = Object.keys(uniformGroup.uniformStructures).map((i) => uniformGroup.uniformStructures[i]);\n      const layout = this._adaptor.createUboElements(elements);\n      const syncFunction = this._generateUboSync(layout.uboElements);\n      uniformData = this._syncFunctionHash[uniformGroupSignature] = {\n        layout,\n        syncFunction\n      };\n    }\n    return this._syncFunctionHash[uniformGroupSignature];\n  }\n  _generateUboSync(uboElements) {\n    return this._adaptor.generateUboSync(uboElements);\n  }\n  syncUniformGroup(uniformGroup, data, offset) {\n    const uniformGroupData = this.getUniformGroupData(uniformGroup);\n    uniformGroup.buffer || (uniformGroup.buffer = new Buffer.Buffer({\n      data: new Float32Array(uniformGroupData.layout.size / 4),\n      usage: _const.BufferUsage.UNIFORM | _const.BufferUsage.COPY_DST\n    }));\n    let dataInt32 = null;\n    if (!data) {\n      data = uniformGroup.buffer.data;\n      dataInt32 = uniformGroup.buffer.dataInt32;\n    }\n    offset || (offset = 0);\n    uniformGroupData.syncFunction(uniformGroup.uniforms, data, dataInt32, offset);\n    return true;\n  }\n  updateUniformGroup(uniformGroup) {\n    if (uniformGroup.isStatic && !uniformGroup._dirtyId)\n      return false;\n    uniformGroup._dirtyId = 0;\n    const synced = this.syncUniformGroup(uniformGroup);\n    uniformGroup.buffer.update();\n    return synced;\n  }\n  destroy() {\n    this._syncFunctionHash = null;\n  }\n}\n\nexports.UboSystem = UboSystem;\n//# sourceMappingURL=UboSystem.js.map\n\n};"],
"names":["shadow$provide","global","require","module","exports","unsafeEvalSupported","Buffer","_const","UboSystem","constructor","adaptor","_syncFunctionHash","Object","create","_adaptor","_systemCheck","Error","ensureUniformGroup","uniformGroup","uniformData","getUniformGroupData","buffer","data","Float32Array","layout","size","usage","BufferUsage","UNIFORM","COPY_DST","_signature","_initUniformGroup","uniformGroupSignature","elements","keys","uniformStructures","map","i","createUboElements","syncFunction","_generateUboSync","uboElements","generateUboSync","syncUniformGroup","offset","uniformGroupData","dataInt32","uniforms","updateUniformGroup","isStatic","_dirtyId","synced","update","destroy"]
}
