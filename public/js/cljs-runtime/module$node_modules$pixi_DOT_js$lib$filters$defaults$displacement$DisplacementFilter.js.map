{
"version":3,
"file":"module$node_modules$pixi_DOT_js$lib$filters$defaults$displacement$DisplacementFilter.js",
"lineCount":34,
"mappings":"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",
"sources":["node_modules/pixi_DOT_js/lib/filters/defaults/displacement/DisplacementFilter.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$pixi_DOT_js$lib$filters$defaults$displacement$DisplacementFilter\"] = function(global,require,module,exports) {\n'use strict';\n\nvar Matrix = require('../../../maths/matrix/Matrix.js');\nvar Point = require('../../../maths/point/Point.js');\nvar GlProgram = require('../../../rendering/renderers/gl/shader/GlProgram.js');\nvar GpuProgram = require('../../../rendering/renderers/gpu/shader/GpuProgram.js');\nvar UniformGroup = require('../../../rendering/renderers/shared/shader/UniformGroup.js');\nvar Sprite = require('../../../scene/sprite/Sprite.js');\nvar deprecation = require('../../../utils/logging/deprecation.js');\nvar Filter = require('../../Filter.js');\nvar displacement$1 = require('./displacement.frag.js');\nvar displacement = require('./displacement.vert.js');\nvar displacement$2 = require('./displacement.wgsl.js');\n\n\"use strict\";\nclass DisplacementFilter extends Filter.Filter {\n  constructor(...args) {\n    let options = args[0];\n    if (options instanceof Sprite.Sprite) {\n      if (args[1]) {\n        deprecation.deprecation(deprecation.v8_0_0, \"DisplacementFilter now uses options object instead of params. {sprite, scale}\");\n      }\n      options = { sprite: options, scale: args[1] };\n    }\n    const { sprite, scale: scaleOption, ...rest } = options;\n    let scale = scaleOption ?? 20;\n    if (typeof scale === \"number\") {\n      scale = new Point.Point(scale, scale);\n    }\n    const filterUniforms = new UniformGroup.UniformGroup({\n      uFilterMatrix: { value: new Matrix.Matrix(), type: \"mat3x3<f32>\" },\n      uScale: { value: scale, type: \"vec2<f32>\" },\n      uRotation: { value: new Float32Array([0, 0, 0, 0]), type: \"mat2x2<f32>\" }\n    });\n    const glProgram = GlProgram.GlProgram.from({\n      vertex: displacement.default,\n      fragment: displacement$1.default,\n      name: \"displacement-filter\"\n    });\n    const gpuProgram = GpuProgram.GpuProgram.from({\n      vertex: {\n        source: displacement$2.default,\n        entryPoint: \"mainVertex\"\n      },\n      fragment: {\n        source: displacement$2.default,\n        entryPoint: \"mainFragment\"\n      }\n    });\n    const textureSource = sprite.texture.source;\n    super({\n      ...rest,\n      gpuProgram,\n      glProgram,\n      resources: {\n        filterUniforms,\n        uMapTexture: textureSource,\n        uMapSampler: textureSource.style\n      }\n    });\n    this._sprite = options.sprite;\n    this._sprite.renderable = false;\n  }\n  /**\n   * Applies the filter.\n   * @param filterManager - The manager.\n   * @param input - The input target.\n   * @param output - The output target.\n   * @param clearMode - clearMode.\n   */\n  apply(filterManager, input, output, clearMode) {\n    const uniforms = this.resources.filterUniforms.uniforms;\n    filterManager.calculateSpriteMatrix(\n      uniforms.uFilterMatrix,\n      this._sprite\n    );\n    const wt = this._sprite.worldTransform;\n    const lenX = Math.sqrt(wt.a * wt.a + wt.b * wt.b);\n    const lenY = Math.sqrt(wt.c * wt.c + wt.d * wt.d);\n    if (lenX !== 0 && lenY !== 0) {\n      uniforms.uRotation[0] = wt.a / lenX;\n      uniforms.uRotation[1] = wt.b / lenX;\n      uniforms.uRotation[2] = wt.c / lenY;\n      uniforms.uRotation[3] = wt.d / lenY;\n    }\n    this.resources.uMapTexture = this._sprite.texture.source;\n    filterManager.applyFilter(this, input, output, clearMode);\n  }\n  /** scaleX, scaleY for displacements */\n  get scale() {\n    return this.resources.filterUniforms.uniforms.uScale;\n  }\n}\n\nexports.DisplacementFilter = DisplacementFilter;\n//# sourceMappingURL=DisplacementFilter.js.map\n\n};"],
"names":["shadow$provide","global","require","module","exports","Matrix","Point","GlProgram","GpuProgram","UniformGroup","Sprite","deprecation","Filter","displacement$1","displacement","displacement$2","DisplacementFilter","constructor","args","options","v8_0_0","sprite","scale","scaleOption","rest","filterUniforms","uFilterMatrix","value","type","uScale","uRotation","Float32Array","glProgram","from","vertex","default","fragment","name","gpuProgram","source","entryPoint","textureSource","texture","resources","uMapTexture","uMapSampler","style","_sprite","renderable","apply","filterManager","input","output","clearMode","uniforms","calculateSpriteMatrix","wt","worldTransform","lenX","Math","sqrt","a","b","lenY","c","d","applyFilter"]
}
